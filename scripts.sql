CREATE TABLE PDF_DOWNLOAD_DMS_CLAIMS (
    -- Primary key
    DOWNLOAD_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    
    -- File identification (from original DMS system)
    FILE_ID VARCHAR2(255) NOT NULL,
    CLAIM_ID NUMBER(20) NOT NULL,
    CLAIM_NO VARCHAR2(100),
    
    -- File information
    REMOTE_FILE_NAME VARCHAR2(255),
    LOCAL_FILE_PATH VARCHAR2(1000),
    FILE_SIZE_BYTES NUMBER,
    
    -- Download tracking
    DOWNLOAD_TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
    STATUS VARCHAR2(20) DEFAULT 'PENDING' NOT NULL,
    ERROR_MESSAGE VARCHAR2(2000),
    
    -- Additional claim information for reporting
    VIN VARCHAR2(50),
    GROSS_CREDIT NUMBER(15,2),
    REPORT_DATE DATE,
    
    -- Audit fields
    CREATED_BY VARCHAR2(100) DEFAULT 'PDF_DOWNLOAD_SERVICE',
    CREATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    LAST_MODIFIED_BY VARCHAR2(100),
    LAST_MODIFIED_DATE TIMESTAMP,
    
    -- Constraints
    CONSTRAINT CHK_PDF_STATUS CHECK (STATUS IN ('PENDING', 'SUCCESS', 'FAILED', 'RETRY')),
    CONSTRAINT UQ_PDF_FILE_ID UNIQUE (FILE_ID)
);

-- Create indexes for better performance
CREATE INDEX IDX_PDF_CLAIM_ID ON PDF_DOWNLOAD_DMS_CLAIMS (CLAIM_ID);
CREATE INDEX IDX_PDF_STATUS ON PDF_DOWNLOAD_DMS_CLAIMS (STATUS);
CREATE INDEX IDX_PDF_DOWNLOAD_DATE ON PDF_DOWNLOAD_DMS_CLAIMS (DOWNLOAD_TIMESTAMP);
CREATE INDEX IDX_PDF_RETRY ON PDF_DOWNLOAD_DMS_CLAIMS (STATUS, RETRY_COUNT, LAST_RETRY_TIMESTAMP);
CREATE INDEX IDX_PDF_REPORT_DATE ON PDF_DOWNLOAD_DMS_CLAIMS (REPORT_DATE);
